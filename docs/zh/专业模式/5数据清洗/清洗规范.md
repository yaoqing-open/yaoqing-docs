## 清洗规范
1. 必须有`WHERE`条件对表的数据做过滤，以保障实时计算数据量限定在范围内。  
    - 天作业 - 限制计算近2天数据，支持每小时补偿一次历史数据，需要使用条件 `WHERE millis >= LAST_2_DAY()` 或 `WHERE timestamp >= LAST_2_DAY_STRING()` 。
    - 小时作业 - 限制计算近3小时数据，支持每5分钟补偿一次历史数据，需要使用条件 `WHERE millis >= LAST_3_HOUR()` 或 `WHERE timestamp >= LAST_3_HOUR_STRING()` 。
    - 分钟作业 - 限制计算近2分钟数据，支持每5分钟补偿一次历史数据，需要使用条件 `WHERE millis >= LAST_2_MINUTE()` 或 `WHERE timestamp >= LAST_2_MINUTE_STRING()` 。
2. 每个表要设置别名，通过别名设置各个表的状态存留时间，以保障实时任务状态不会无限增长而崩溃。  
    - 天作业 - 所有状态默认保存3天。
    - 小时作业 - 所有状态默认保存4小时。
    - 分钟作业 - 所有状态默认保存3分钟。
    - 注：如果有维表，则应该使用`STATE_TTL`注解，自定义每个表状态的保留时间，其中维表设置为0s，即永不过期，其他表按需求设置。
    ```sql
    -- 示例: right_table 为维表
    SELECT /*+ STATE_TTL('A' = '3d', 'B' = '0s')*/ ...... FROM 
    left_table as A LEFT JOIN right_table as B ON ... 
    WHERE A.time >= LAST_2_DAY_STRING() ....;
    ```
3. 如有时区转换需求，则请不要直接基于原始时间汇聚成天任务，应该先创建小时任务处理好时区转换，然后再汇聚成天。
4. 进行 `LEFT JOIN` 时，建议将事实流（如订单表）放在左侧，维表（如商品表）放在右侧。  
5. 尽量各表先自行进行过滤聚合，然后再进行关联，减少 JOIN 状态压力。    

